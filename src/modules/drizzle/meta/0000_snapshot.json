{
  "id": "00000000-0000-0000-0000-000000000000",
  "prevId": "",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.harvests": {
      "name": "harvests",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "quantity_kg": {
          "name": "quantity_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": true
        },
        "cost_per_kg": {
          "name": "cost_per_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "harvester_id": {
          "name": "harvester_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "harvest_date": {
          "name": "harvest_date",
          "type": "date",
          "primaryKey": false,
          "notNull": true,
          "default": "CURRENT_DATE"
        },
        "additional_payment": {
          "name": "additional_payment",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false,
          "default": "'0'"
        },
        "is_purchased": {
          "name": "is_purchased",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "batch_id": {
          "name": "batch_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idx_harvests_batch_id": {
          "name": "idx_harvests_batch_id",
          "columns": [
            {
              "expression": "batch_id",
              "asc": true,
              "nulls": "last",
              "opclass": "int4_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "harvests_harvester_id_fkey": {
          "name": "harvests_harvester_id_fkey",
          "tableFrom": "harvests",
          "tableTo": "people",
          "schemaTo": "public",
          "columnsFrom": [
            "harvester_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "fk_harvests_batch": {
          "name": "fk_harvests_batch",
          "tableFrom": "harvests",
          "tableTo": "batches",
          "schemaTo": "public",
          "columnsFrom": [
            "batch_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {},
      "isRLSEnabled": false
    },
    "public.people": {
      "name": "people",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "full_name": {
          "name": "full_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "nickname": {
          "name": "nickname",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "phone_number": {
          "name": "phone_number",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false
        },
        "registration_date": {
          "name": "registration_date",
          "type": "date",
          "primaryKey": false,
          "notNull": true,
          "default": "CURRENT_DATE"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {},
      "isRLSEnabled": false
    },
    "public.batches": {
      "name": "batches",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "average_price_per_kg": {
          "name": "average_price_per_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "harvest_date": {
          "name": "harvest_date",
          "type": "date",
          "primaryKey": false,
          "notNull": false
        },
        "received_date": {
          "name": "received_date",
          "type": "date",
          "primaryKey": false,
          "notNull": false
        },
        "notes": {
          "name": "notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {},
      "isRLSEnabled": false
    },
    "public.sales": {
      "name": "sales",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "batch_id": {
          "name": "batch_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "receiver_id": {
          "name": "receiver_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "vehicle_id": {
          "name": "vehicle_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "quantity_kg": {
          "name": "quantity_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": true
        },
        "price_per_kg": {
          "name": "price_per_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": true
        },
        "delivery_cost": {
          "name": "delivery_cost",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false,
          "default": "'0'"
        },
        "sale_date": {
          "name": "sale_date",
          "type": "date",
          "primaryKey": false,
          "notNull": true,
          "default": "CURRENT_DATE"
        },
        "status": {
          "name": "status",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false,
          "default": "'processing'"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "sales_batch_id_fkey": {
          "name": "sales_batch_id_fkey",
          "tableFrom": "sales",
          "tableTo": "batches",
          "schemaTo": "public",
          "columnsFrom": [
            "batch_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "sales_receiver_id_fkey": {
          "name": "sales_receiver_id_fkey",
          "tableFrom": "sales",
          "tableTo": "receivers",
          "schemaTo": "public",
          "columnsFrom": [
            "receiver_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "restrict",
          "onUpdate": "no action"
        },
        "sales_vehicle_id_fkey": {
          "name": "sales_vehicle_id_fkey",
          "tableFrom": "sales",
          "tableTo": "vehicles",
          "schemaTo": "public",
          "columnsFrom": [
            "vehicle_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {},
      "isRLSEnabled": false
    },
    "public.receivers": {
      "name": "receivers",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "phone": {
          "name": "phone",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false
        },
        "active": {
          "name": "active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {},
      "isRLSEnabled": false
    },
    "public.vehicles": {
      "name": "vehicles",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "license_plate": {
          "name": "license_plate",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true
        },
        "model": {
          "name": "model",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "capacity_kg": {
          "name": "capacity_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "active": {
          "name": "active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "vehicles_license_plate_key": {
          "columns": [
            "license_plate"
          ],
          "nullsNotDistinct": false,
          "name": "vehicles_license_plate_key"
        }
      },
      "checkConstraints": {},
      "policies": {},
      "isRLSEnabled": false
    },
    "public.receiver_quotes": {
      "name": "receiver_quotes",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "receiver_id": {
          "name": "receiver_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "quoted_price_per_kg": {
          "name": "quoted_price_per_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": true
        },
        "quote_date": {
          "name": "quote_date",
          "type": "date",
          "primaryKey": false,
          "notNull": true,
          "default": "CURRENT_DATE"
        },
        "notes": {
          "name": "notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "receiver_quotes_receiver_id_fkey": {
          "name": "receiver_quotes_receiver_id_fkey",
          "tableFrom": "receiver_quotes",
          "tableTo": "receivers",
          "schemaTo": "public",
          "columnsFrom": [
            "receiver_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {},
      "isRLSEnabled": false
    }
  },
  "enums": {},
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {
    "public.harvest_summary": {
      "name": "harvest_summary",
      "schema": "public",
      "columns": {
        "harvest_date": {
          "name": "harvest_date",
          "type": "date",
          "primaryKey": false,
          "notNull": false
        },
        "total_harvesters": {
          "name": "total_harvesters",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "total_quantity_kg": {
          "name": "total_quantity_kg",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "total_base_cost": {
          "name": "total_base_cost",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "total_additional_payments": {
          "name": "total_additional_payments",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "total_cost_with_payments": {
          "name": "total_cost_with_payments",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        }
      },
      "isExisting": false,
      "definition": "SELECT harvest_date, count(*) AS total_harvesters, sum(quantity_kg) AS total_quantity_kg, sum(quantity_kg * cost_per_kg) AS total_base_cost, sum(additional_payment) AS total_additional_payments, sum(quantity_kg * cost_per_kg + additional_payment) AS total_cost_with_payments FROM harvests h GROUP BY harvest_date",
      "materialized": false
    },
    "public.harvester_details": {
      "name": "harvester_details",
      "schema": "public",
      "columns": {
        "full_name": {
          "name": "full_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "nickname": {
          "name": "nickname",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "quantity_kg": {
          "name": "quantity_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "cost_per_kg": {
          "name": "cost_per_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "base_amount": {
          "name": "base_amount",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "additional_payment": {
          "name": "additional_payment",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "total_amount": {
          "name": "total_amount",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "harvest_date": {
          "name": "harvest_date",
          "type": "date",
          "primaryKey": false,
          "notNull": false
        }
      },
      "isExisting": false,
      "definition": "SELECT p.full_name, p.nickname, h.quantity_kg, h.cost_per_kg, h.quantity_kg * h.cost_per_kg AS base_amount, h.additional_payment, h.quantity_kg * h.cost_per_kg + h.additional_payment AS total_amount, h.harvest_date FROM harvests h JOIN people p ON h.harvester_id = p.id ORDER BY h.harvest_date DESC, h.id",
      "materialized": false
    },
    "public.batch_profitability": {
      "name": "batch_profitability",
      "schema": "public",
      "columns": {
        "batch_id": {
          "name": "batch_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "harvest_date": {
          "name": "harvest_date",
          "type": "date",
          "primaryKey": false,
          "notNull": false
        },
        "received_date": {
          "name": "received_date",
          "type": "date",
          "primaryKey": false,
          "notNull": false
        },
        "total_quantity_kg": {
          "name": "total_quantity_kg",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "total_harvest_cost": {
          "name": "total_harvest_cost",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "actual_selling_price": {
          "name": "actual_selling_price",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "actual_revenue": {
          "name": "actual_revenue",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "actual_profit": {
          "name": "actual_profit",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        }
      },
      "isExisting": false,
      "definition": "SELECT b.id AS batch_id, b.harvest_date, b.received_date, hs.total_quantity_kg, hs.total_cost_with_payments AS total_harvest_cost, COALESCE(s.actual_selling_price, 0::numeric) AS actual_selling_price, COALESCE(s.actual_revenue, 0::numeric) AS actual_revenue, COALESCE(s.actual_revenue - hs.total_cost_with_payments, 0::numeric) AS actual_profit FROM batches b JOIN harvest_summary hs ON b.harvest_date = hs.harvest_date LEFT JOIN ( SELECT sales.batch_id, sum(sales.price_per_kg * sales.quantity_kg) / sum(sales.quantity_kg) AS actual_selling_price, sum(sales.price_per_kg * sales.quantity_kg) AS actual_revenue FROM sales WHERE sales.status::text = 'completed'::text GROUP BY sales.batch_id) s ON b.id = s.batch_id",
      "materialized": false
    },
    "public.actual_sales": {
      "name": "actual_sales",
      "schema": "public",
      "columns": {
        "sale_date": {
          "name": "sale_date",
          "type": "date",
          "primaryKey": false,
          "notNull": false
        },
        "receiver_name": {
          "name": "receiver_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "quantity_kg": {
          "name": "quantity_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "price_per_kg": {
          "name": "price_per_kg",
          "type": "numeric(10, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "total_amount": {
          "name": "total_amount",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        }
      },
      "isExisting": false,
      "definition": "SELECT s.sale_date, r.name AS receiver_name, s.quantity_kg, s.price_per_kg, s.quantity_kg * s.price_per_kg AS total_amount, s.status FROM sales s JOIN receivers r ON s.receiver_id = r.id ORDER BY s.sale_date DESC",
      "materialized": false
    }
  },
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {}
  },
  "internal": {
    "tables": {}
  }
}